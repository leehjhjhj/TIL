## 인덱스 설계가 어려운 이유

- SQL 각각에 맞는 인덱스를 생성하면 되지만, 인덱스가 많아질 수록 당므과 같은 문제가 생긴다.
    - DML 성능 저하 → TPS 저하
    - 데이터베이스 사이즈 증가 → 디스크 공간 낭비
    - 데이터베이스 관리 및 운영 비용 상승
- 따라서 시스템 전체 시각에서 종합적, 전략적으로 접근해야함

## 가장 중요한 두 가지 선택 기준

- 조건절에 항상 사용하거나, 자주 사용하는 컬럼을 선정한다.
- `=` 조건으로 자주 조회하는 컬럼을 앞쪽에 둔다.

## 스캔 효율성 이외의 판단 기준

- 여러가지 판단 기준이 있지만, 단연 중요한 것은 **수행 빈도 이다.**
- 수행빈도가 높은 SQL이면, 테스트 과정에서 성능이 좋게 나와도 인덱스를 최적으로 구성해줘야 한다.
- 데이터량도 인덱스 설계시 중요한 판단 기준이다

## 공식을 초월한 전략적 설계

- 조건절이 열 개 있다고 했을 때, 패턴마다 인덱스를 하나씩 만들 수 없다.
- 취급 부서, 취급 지점 … 등 6개의 조회 방식과 4개의 일자, 일시를 하나 고른다고 가정하자.
- 효율적인 스캔을 위해 `=`  + `BETWEEN` 을 사용하려면 24개의 인덱스가 필요하다.
- 이럴 때, 일자 일시 조건을 선두에두고 뒤의 조회 방식을 모두 뒤쪽에 나열 추가, 총 4개의 인덱스를 만든다.
- 그리고 가장 많이 발생하는 쿼리의 인덱스를 따로 뺀다.
- 많이 발생하지 않은 쿼리는 다소 인덱스 필터 조건으로 검색하게끔 한 다음, 중요한 쿼리의 인덱스를 추가하는 전략적 설계를 하는 것도 좋은 방법이다.